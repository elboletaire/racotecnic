<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Racó Tècnic</title>
<meta name="description" content="Punt de trobada de coneixements">
<meta name="keywords" content="development, hardware, software, audio, video, mapping, php, bash, apache, nginx, cakephp, git">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="//elboletaire.github.io/racotecnic/images/el-carmel-viewpoint.jpg">

<meta name="twitter:title" content="Racó Tècnic">
<meta name="twitter:description" content="Punt de trobada de coneixements">
<meta name="twitter:creator" content="@racotecnic">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Racó Tècnic">
<meta property="og:description" content="Punt de trobada de coneixements">
<meta property="og:url" content="//elboletaire.github.io/racotecnic/page/4/">
<meta property="og:site_name" content="Racó Tècnic">





<link rel="canonical" href="//elboletaire.github.io/racotecnic/page/4/">
<link href="//elboletaire.github.io/racotecnic/feed.xml" type="application/atom+xml" rel="alternate" title="Racó Tècnic Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="//elboletaire.github.io/racotecnic/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="//elboletaire.github.io/racotecnic/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="//elboletaire.github.io/racotecnic/assets/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="//elboletaire.github.io/racotecnic/assets/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="//elboletaire.github.io/racotecnic/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="//elboletaire.github.io/racotecnic/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="//elboletaire.github.io/racotecnic/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="//elboletaire.github.io/racotecnic/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="//elboletaire.github.io/racotecnic/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="//elboletaire.github.io/racotecnic/images/" alt="Racó Tècnic photo" class="author-photo">
					<h4>Racó Tècnic</h4>
					<p>A subproject from <a href="http://underave.net">underave.net</a> created by <a href="https://github.com/elboletaire">elboletaire</a> and maintained by many collaborators.</p>
				</li>
				<li><a href="//elboletaire.github.io/racotecnic/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:elboletaire@underave.net"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="https://twitter.com/racotecnic"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="https://facebook.com/racotecnic"><i class="fa fa-fw fa-facebook"></i> Facebook</a>
				</li>
				
				
				<li>
					<a href="https://github.com/elboletaire/racotecnic"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="//elboletaire.github.io/racotecnic/posts/">All Posts</a></li>
				<li><a href="//elboletaire.github.io/racotecnic/tags/">All Tags</a></li>
				<li><a href="//elboletaire.github.io/racotecnic/categories/">All Categories</a></li>
			</ul>
		</li>
		
	    
	    <li><a href="https://github.com/elboletaire/racotecnic" target="_blank">Github</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  <div class="image-credit">Image source: <a href="https://github.com/elboletaire/Watimage/blob/master/examples/files/LICENSE">elboletaire</a></div><!-- /.image-credit -->
  
    <div class="entry-image" style="background-image: url(//elboletaire.github.io/racotecnic/images/el-carmel-viewpoint.jpg);">
      <img src="//elboletaire.github.io/racotecnic/images/el-carmel-viewpoint.jpg" alt="">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Racó Tècnic</h1>
      <h2>Punt de trobada de coneixements</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated">
        <time datetime="2011-04-01T15:44:46+02:00">
          <a href="//elboletaire.github.io/racotecnic/2011/04/ucfirst-y-lcfirst-compatibles-con-acentos-multi-byte/">April 01, 2011</a>
        </time>
      </span>
      <span class="author vcard"><span class="fn">
        
        <a href="http://www.underave.net" title="About Booletaire">
          Booletaire
        </a>
        
      </span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//elboletaire.github.io/racotecnic/2011/04/ucfirst-y-lcfirst-compatibles-con-acentos-multi-byte/" rel="bookmark" title="ucfirst y lcfirst compatibles con acentos (Multi Byte)" itemprop="url">ucfirst y lcfirst compatibles con acentos (Multi Byte)</a></h1>
    
  </header>
  <div class="entry-content">
    <p><a href="//elboletaire.github.io/racotecnic/uploads/2011/04/mb1.png"><img class="alignleft size-full wp-image-1884" title="mb" src="//elboletaire.github.io/racotecnic/uploads/2011/04/mb1.png" alt="" width="205" height="195" /></a>Llevo un rato peleándome con esto y finalmente he encontrado solución.</p>

<p>El caso es que los de PHP al hacer los métodos <a title="PHP: MultiByte String Functions" href="http://php.net/manual/en/ref.mbstring.php">MultiByte</a> (un apaño que harían al ver que se olvidaron del resto de juegos de caracteres…) no hicieron ni el de primera letra mayúscula ni minúscula.</p>

<p>Ambos métodos me son muy útiles para activar / desactivar usuarios de una wiki (ya que un usuario no puede acceder al sistema mediawiki si tiene la primera letra en minúscula), así que en realidad no he tenido más remedio que hacerlo (nooo, yo no queríaaa..!! xD)<a id="more"></a><a id="more-1873"></a></p>

<div class="language-php highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><pre><span class="cp">&lt;?php</span>
<span class="c1">// First letter uppercase
</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">'mb_ucfirst'</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">function</span> <span class="nf">mb_ucfirst</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$to_lower</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">$charset</span> <span class="o">=</span> <span class="s1">'utf-8'</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="nv">$first</span> <span class="o">=</span> <span class="nb">mb_strtoupper</span><span class="p">(</span><span class="nb">mb_substr</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">$charset</span><span class="p">),</span> <span class="nv">$charset</span><span class="p">);</span>
    <span class="nv">$end</span> <span class="o">=</span> <span class="nb">mb_substr</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">mb_strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$charset</span><span class="p">),</span> <span class="nv">$charset</span><span class="p">);</span>
    <span class="c1">// Convert them all to lowercase (if specified)
</span>    <span class="k">if</span> <span class="p">(</span><span class="nv">$to_lower</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$end</span> <span class="o">=</span> <span class="nb">mb_strtolower</span><span class="p">(</span><span class="nv">$end</span><span class="p">,</span> <span class="nv">$charset</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$first</span> <span class="o">.</span> <span class="nv">$end</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// First letter lowercase
</span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">'mb_lcfirst'</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">function</span> <span class="nf">mb_lcfirst</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$charset</span> <span class="o">=</span> <span class="s1">'utf-8'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$first</span> <span class="o">=</span> <span class="nb">mb_strtolower</span><span class="p">(</span><span class="nb">mb_substr</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">$charset</span><span class="p">),</span> <span class="nv">$charset</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$first</span> <span class="o">.</span> <span class="nb">mb_substr</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">mb_strlen</span><span class="p">(</span><span class="nv">$str</span><span class="p">,</span> <span class="nv">$charset</span><span class="p">),</span> <span class="nv">$charset</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Como podréis ver al método <code class="highlighter-rouge">mb_ucfirst</code> le he añadido un parámetro <code class="highlighter-rouge">$to_lower</code> que sirve para convertir el resto de la frase a minúscula (muy útil contra hoygans).</p>

<p>El parámetro <code class="highlighter-rouge">$charset</code> es el que más me ha dado por culo (al principio no lo tenía en cuenta); tened en cuenta vuestra codificación de caracteres y cambiadlo directamente en la función si es preciso.</p>

<p>Buen fin de semana!</p>

<blockquote>
  <p><strong>Referencias</strong></p>

  <ul>
    <li><a title="php.net" href="http://php.net/manual/en/ref.mbstring.php">PHP: Multibyte String Functions</a></li>
  </ul>
</blockquote>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry no-line-numbers">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated">
        <time datetime="2011-03-16T23:18:00+01:00">
          <a href="//elboletaire.github.io/racotecnic/2011/03/acceso-root-a-estructura-de-ficheros-so-android-2-2-en-toshiba-folio-100/">March 16, 2011</a>
        </time>
      </span>
      <span class="author vcard"><span class="fn">
        
          
            manuso245
          
        
      </span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~3 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//elboletaire.github.io/racotecnic/2011/03/acceso-root-a-estructura-de-ficheros-so-android-2-2-en-toshiba-folio-100/" rel="bookmark" title="Acceso root a estructura de ficheros SO Android 2.2 en Toshiba Folio 100" itemprop="url">Acceso root a estructura de ficheros SO Android 2.2 en Toshiba Folio 100</a></h1>
    
  </header>
  <div class="entry-content">
    <h2 id="requisitos-">Requisitos <img class="alignright size-full wp-image-1861" title="android-logo" src="//elboletaire.github.io/racotecnic/uploads/2011/03/android-logo.jpg" alt="" width="158" height="178" /></h2>

<ol>
  <li>Ubuntu 9.10. Testeado por otros usuarios en 10.04</li>
  <li><a href="http://developer.android.com/sdk/index.html">Android SDK y platform-tools</a> concretamente la herramienta <a href="http://developer.android.com/guide/developing/tools/adb.html">ADB</a> (Android Debug Bridge)</li>
  <li>Un dispositivo Android, en mi caso una <a href="http://www.toshiba-multimedia.com/es/journe-tabletas-marcos-digitales/folio100/">Tablet Toshiba Folio 100</a> con Android 2.2 con el SO cambiado (el test se realizó con el <a href="http://dext3r.komodin.org/">TNTModFolio de Dexter</a>)</li>
</ol>

<h2 id="definición-conceptual">Definición Conceptual</h2>

<p>Nuestro problema principal era que teníamos una web desarrollada en un servidor de test y para acceder a ella necesitábamos modificar el archivo «<em>hosts</em>» para añadir una directiva de nombres.</p>

<p>Lo primero que apreciamos en la Tablet de Toshiba fue que no podíamos acceder al market ni a las google apps ya que viene restringido de fábrica. Nos decantamos, así, por instalar un mod del SO desarrollado por Dexter. Estos mods tienen una eficacia y mejoras contrastadas y nos decidimos finalmente por el TNTMod.</p>

<p>El TNTMod te permite tener permisos <em>root </em>en tu dispositivo pero para modificar los archivos de sistema hay que ser un poco más creativo.</p>

<p>El único método que me ha dado resultado es el uso y configuración de ADB, una aplicación estilo <em>putty </em>para acceder mediante <em>Shell </em>o comando típicos como <em>pull </em>o <em>push </em>a los archivos de SO de un dispositivo Android. Mediante ADB es posible conectarse con un terminal a los archivos de sistema y comprobar la ruta del archivo hosts. También permite traértelo al pc local, modificarlo y después volverlo a meter en el sistema de archivos del dispositivo.<a id="more"></a><a id="more-1859"></a></p>

<h2 id="procedimiento">Procedimiento</h2>

<p>Primero de todo hay que descargar e instalar android SDK (necesitarrás JAVA SDK):</p>

<ul>
  <li>Descargar tar.gz para Linux</li>
  <li>Extraer en carpeta personal</li>
  <li>Acceder a <code class="highlighter-rouge">/home/carpeta_personal/android-sdk/tools/android</code></li>
  <li>Instalar todos paquetes disponibles</li>
</ul>

<p>Ahora es momento de conectar la Toshiba Folio 100 al PC y hacer lo siguiente…</p>

<ul>
  <li>Activar el USB DEBUG en Android (<strong><em>Ajustes -&gt; Aplicaciones -&gt; Desarrollo)</em></strong></li>
  <li><code class="highlighter-rouge">/home/carpeta_personal/android-sdk/platform-tool/adb devices</code></li>
  <li>Nos devolverá una salida de este tipo: <strong><em>???????? No Permissions</em></strong></li>
</ul>

<p>Hay que configurar el driver para que reconozca la Tablet:</p>

<ul>
  <li>Entrar en <code class="highlighter-rouge">/etc/udev/rules.d/</code></li>
  <li>Dentro de este directorio tiene que haber un fichero llamado <code class="highlighter-rouge">51-android.rules</code> o con otro número.</li>
  <li>Editamos este fichero para añadir la siguiente línea:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="nv">SUBSYSTEMS</span><span class="o">==</span><span class="s1">'usb'</span>, ATTRS<span class="o">{</span>idVendor<span class="o">}==</span><span class="s1">'0bb4'</span>,ATTRS<span class="o">{</span>idProduct<span class="o">}==</span><span class="s1">'0c97'</span>, <span class="nv">MODE</span><span class="o">=</span><span class="s1">'0666'</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Como, seguramente, no sabremos el idVendor y el idProduct del dispositivo hacemos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>lsusb
</pre></td></tr></tbody></table>
</div>
</div>

<p>Esto nos mostrará la información de los dispositivos usb conectados.</p>

<p>Seguidamente le damos permisos y reiniciamos el server de ADB:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8</pre></td><td class="code"><pre>sudo chmod a+r /etc/udev/rules.d/51-android.rules
sudo ~/android-sdk/tools/adb <span class="nb">kill</span>-server
sudo ~/android-sdk/tools/adb start-server
<span class="c"># * daemon not running. starting it now on port 5037 *</span>
<span class="c"># * daemon started successfully *</span>
~/android-sdk/tools/adb devices
<span class="c"># List of devices attached</span>
<span class="c"># HT03JNX00008 device</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Una vez tenemos el dispositivo vamos a acceder a él:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13</pre></td><td class="code"><pre>~/android-sdk/tools/adb shell
su
mount
<span class="c"># rootfs / rootfs ro 0 0</span>
<span class="c"># tmpfs /dev tmpfs rw,mode=755 0 0</span>
<span class="c"># devpts /dev/pts devpts rw,mode=600 0 0</span>
<span class="c"># proc /proc proc rw 0 0</span>
<span class="c"># sysfs /sys sysfs rw 0 0</span>
<span class="c"># tmpfs /sqlite_stmt_journals tmpfs rw,size=4096k 0 0</span>
<span class="c"># /dev/block/mtdblock3 /system yaffs2 ro 0 0</span>
<span class="c"># /dev/block/mtdblock5 /data yaffs2 rw,nosuid,nodev 0 0</span>
<span class="c"># /dev/block/mtdblock4 /cache yaffs2 rw,nosuid,nodev 0 0</span>
<span class="c"># /dev/block/mmcblk0p1 /sdcard vfat rw,dirsync,nosuid,nodev,noexec,uid=1000,gid=1000,fmask=0711,dmask=0700,codepage=cp437,iocharset=iso8859-1,utf8 0 0</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Remontamos el FS como rw para poder escribir o hacer pushes:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre>mount -o remount,rw -t yaffs2 /dev/block/mtdblock3 /system
</pre></td></tr></tbody></table>
</div>
</div>

<p><strong>YA TENEMOS ACCESO COMPLETO</strong></p>

<h2 id="cosas-a-tener-en-cuenta">Cosas a tener en cuenta</h2>

<p>Si apagamos el dispositivo habrá que hacer otra vez la parte del mount ya que el dispositivo por defecto monta /system en ro. Si se desea dejar permanentemente en rw modificar reglas de mount.</p>

<p>En todo momento del proceso hay que activar el modo debug de USB en la distro de Android que utilicemos.</p>
<div id="_mcePaste" class="mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;"><img class="aligncenter size-full wp-image-1864" title="android" src="//elboletaire.github.io/racotecnic/uploads/2011/03/android.jpg" alt="" width="570" height="356" /></div>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated">
        <time datetime="2011-02-13T23:23:36+01:00">
          <a href="//elboletaire.github.io/racotecnic/2011/02/crear-un-podcast-en-cakephp/">February 13, 2011</a>
        </time>
      </span>
      <span class="author vcard"><span class="fn">
        
        <a href="http://www.underave.net" title="About Booletaire">
          Booletaire
        </a>
        
      </span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~8 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//elboletaire.github.io/racotecnic/2011/02/crear-un-podcast-en-cakephp/" rel="bookmark" title="Crear un Podcast en CakePHP" itemprop="url">Crear un Podcast en CakePHP</a></h1>
    
  </header>
  <div class="entry-content">
    <p><img style="margin-left: 20px;" title="podcast icon" src="//elboletaire.github.io/racotecnic/uploads/2011/01/podcast_icon.png" alt="" /></p>

<p>El otro día expliqué <a href="//elboletaire.github.io/racotecnic/2011/01/unir-ficheros-mp3-en-un-unico-fichero-mp3-con-cakephp/" target="_self"><strong>cómo unir ficheros mp3 en un mismo fichero</strong></a> y dije que dejaría para más tarde lo de la creación del <strong>Podcast</strong>. Vamos a ello pues.</p>

<p>Para <strong>crear nuestro Podcast</strong> necesitaremos, a parte de CakePHP, la librería getid3, ya que para que itunes coja bien las imágenes de cada podcast lo mejor que podemos hacer es añadir la imagen al mp3 directamente.</p>

<p>Suponiendo que habéis leído <a href="//elboletaire.github.io/racotecnic/2011/01/unir-ficheros-mp3-en-un-unico-fichero-mp3-con-cakephp/" target="_self">el tutorial del otro día</a> voy a ir directo al grano…</p>

<p>Lo primero que haremos es escribir la información ID3 a nuestro fichero de podcast. Para el ejemplo utilizaré el componente que tengo hecho para <a href="http://getid3.org" target="_self">getid3</a> y que he(mos) utilizado anteriormente. Lo podéis descargar del post anterior o de <a href="https://github.com/elboletaire/CakePHP-Getid3-Component" target="_self">github</a>.<a id="more"></a><a id="more-1760"></a></p>

<div class="language-php highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></td><td class="code"><pre><span class="cp">&lt;?php</span>
<span class="c1">// .. aquí tendríamos la carga del mp3 al servidor o la unión de los mp3 ..
// ....
// Escribimos la información id3..
</span><span class="nv">$id3_data</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'title'</span>   <span class="o">=&gt;</span> <span class="s1">'Título del podcast'</span><span class="p">,</span>
  <span class="s1">'artist'</span>  <span class="o">=&gt;</span> <span class="s1">'Artista(s)'</span><span class="p">,</span>
  <span class="s1">'album'</span>   <span class="o">=&gt;</span> <span class="s1">'Álbum'</span><span class="p">,</span>
  <span class="s1">'year'</span>    <span class="o">=&gt;</span> <span class="s1">'Año'</span><span class="p">,</span>
  <span class="s1">'genre'</span>   <span class="o">=&gt;</span> <span class="s1">'Género musical'</span><span class="p">,</span>
  <span class="s1">'comment'</span> <span class="o">=&gt;</span> <span class="s1">'Comentario'</span><span class="p">,</span>
  <span class="s1">'images'</span>  <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
      <span class="s1">'image'</span>       <span class="o">=&gt;</span> <span class="s1">'/ruta/completa/hacia/la/imagen.jpg'</span><span class="p">,</span>
      <span class="s1">'type'</span>        <span class="o">=&gt;</span> <span class="s1">'cover'</span><span class="p">,</span> <span class="c1">// tipos válidos: cover, back y cd,
</span>      <span class="s1">'mime'</span>        <span class="o">=&gt;</span> <span class="s1">'image/jpg'</span><span class="p">,</span>
      <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Nombre o descripción que queramos poner'</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
      <span class="s1">'image'</span>       <span class="o">=&gt;</span> <span class="s1">'/ruta/completa/hacia/la/imagen.jpg'</span><span class="p">,</span>
      <span class="s1">'type'</span>        <span class="o">=&gt;</span> <span class="s1">'cover'</span><span class="p">,</span> <span class="c1">// tipos válidos: cover, back y cd,
</span>      <span class="s1">'mime'</span>        <span class="o">=&gt;</span> <span class="s1">'image/jpg'</span><span class="p">,</span>
      <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="s1">'Nombre o descripción que queramos poner'</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
      <span class="c1">// ... más imágenes (itunes sólo carga una, así que a partir de la primera es ocupar más espacio..
</span>    <span class="p">)</span>
  <span class="p">)</span>
<span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Getid3</span><span class="o">-&gt;</span><span class="na">write</span><span class="p">(</span><span class="nv">$podcast</span><span class="p">,</span> <span class="nv">$id3_data</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1">// Los datos se han escrito correctamente
</span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">pr</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Getid3</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Con algún programa para gestionar etiquetas <em>id3 </em>(como <a href="http://kid3.sourceforge.net/" target="_self">kid3</a> por ejemplo) o con un simple reproductor podréis comprobar si se han escrito correctamente las etiquetas <em>id3</em>.</p>

<p>Ahora necesitamos crear una plantilla (<em>layout</em>) para nuestro podcast, ya que la estructura básica de un podcast difiere un poco respecto a la de un RSS convencional.</p>

<p>Para no complicarnos mucho y para hacer este layout lo más versátil posible simplemente concatenaremos los elementos que nos interesen delante del contenido (cada ítem del podcast). Así que a partir del <a href="http://book.cakephp.org/view/1461/Creating-an-RSS-feed-with-the-RssHelper" target="_self">layout de RSS de CakePHP</a>…</p>

<div class="language-php highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20</pre></td><td class="code"><pre><span class="cp">&lt;?php</span>
<span class="c1">// /app/views/layouts/xml/podcast.ctp
</span><span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Rss</span><span class="o">-&gt;</span><span class="na">header</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$documentData</span><span class="p">))</span> <span class="p">{</span>
  <span class="nv">$documentData</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$channelData</span><span class="p">))</span> <span class="p">{</span>
  <span class="nv">$channelData</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$channelData</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]))</span> <span class="p">{</span>
  <span class="nv">$channelData</span><span class="p">[</span><span class="s1">'title'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$title_for_layout</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$before</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$beforeContent</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$beforeContent</span><span class="p">))</span> <span class="p">{</span>
  <span class="k">foreach</span> <span class="p">(</span><span class="nv">$beforeContent</span> <span class="k">as</span> <span class="nv">$i</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$before</span> <span class="o">.=</span> <span class="nv">$i</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nv">$channel</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Rss</span><span class="o">-&gt;</span><span class="na">channel</span><span class="p">(</span><span class="k">array</span><span class="p">(),</span> <span class="nv">$channelData</span><span class="p">,</span> <span class="nv">$before</span> <span class="o">.</span> <span class="nv">$content_for_layout</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Rss</span><span class="o">-&gt;</span><span class="na">document</span><span class="p">(</span><span class="nv">$documentData</span><span class="p">,</span><span class="nv">$channel</span><span class="p">);</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Lo único que he hecho es añadir las líneas 13 a 20 y la variable <code class="highlighter-rouge">$before</code> en la línea 21.</p>

<p>Con esto podremos <strong>mandar un array de elementos XML</strong> desde nuestra vista del podcast con toda la información extra que queramos. Si no acabáis de verlo tranquilos porque ahora con la vista del podcast os acabará de quedar claro.</p>

<p>Del mismo modo que con el layout, utilizo como base <a href="http://book.cakephp.org/view/1461/Creating-an-RSS-feed-with-the-RssHelper" target="_self">la vista de RSS de CakePHP</a>.</p>

<p>Aquí viene la vista:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre></td><td class="code"><pre><span class="cp">&lt;?php</span>
<span class="c1">// /app/views/podcasts/podcasts/index.ctp
// Pasamos info a la variable documentData del layout
</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'documentData'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'xmlns:itunes'</span> <span class="o">=&gt;</span> <span class="s1">'http://www.itunes.com/dtds/podcast-1.0.dtd'</span><span class="p">));</span>
<span class="c1">// Pasamos información a la variable channelData del layout
</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'channelData'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
  <span class="s1">'title'</span>       <span class="o">=&gt;</span> <span class="s1">'Racó Tècnic Podcast'</span><span class="p">,</span>
  <span class="s1">'link'</span>        <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">'controller'</span> <span class="o">=&gt;</span> <span class="s1">'podcasts'</span><span class="p">,</span> <span class="s1">'action'</span> <span class="o">=&gt;</span> <span class="s1">'index'</span><span class="p">),</span> <span class="kc">true</span><span class="p">),</span>
  <span class="s1">'description'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span><span class="s1">'Racó Tècnic Audio &amp; Video Podcasts.'</span><span class="p">,</span> <span class="kc">true</span><span class="p">),</span>
  <span class="s1">'language'</span>    <span class="o">=&gt;</span> <span class="s1">'es'</span><span class="p">,</span>
  <span class="s1">'image'</span>       <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span>    <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="s1">'/img/logo.jpg'</span><span class="p">,</span> <span class="kc">true</span><span class="p">),</span>
    <span class="s1">'link'</span>   <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="kc">true</span><span class="p">),</span>
    <span class="s1">'width'</span>  <span class="o">=&gt;</span> <span class="mi">144</span><span class="p">,</span>
    <span class="s1">'height'</span> <span class="o">=&gt;</span> <span class="mi">144</span><span class="p">,</span>
    <span class="s1">'title'</span>  <span class="o">=&gt;</span> <span class="s1">'Racó Tècnic logo'</span>
  <span class="p">)</span>
<span class="p">));</span>

<span class="c1">// Aquí pasamos la información a la variable $beforeContent del layout
</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">'beforeContent'</span><span class="p">,</span>
  <span class="k">array</span><span class="p">(</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'image'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">'namespace'</span> <span class="o">=&gt;</span> <span class="s1">'itunes'</span><span class="p">,</span>
      <span class="s1">'href'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="s1">'/img/logo.jpg'</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">)),</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'author'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'namespace'</span> <span class="o">=&gt;</span> <span class="s1">'itunes'</span><span class="p">),</span> <span class="s1">'El Boletaire'</span><span class="p">)</span>
  <span class="p">)</span>
<span class="p">);</span>
<span class="c1">// Empezamos a añadir &lt;item&gt;s a nuestro fichero podcast
</span><span class="k">foreach</span> <span class="p">(</span><span class="nv">$podcasts</span> <span class="k">as</span> <span class="nv">$podcast</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nv">$time</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Podcast'</span><span class="p">][</span><span class="s1">'created'</span><span class="p">]);</span>

  <span class="nv">$link</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'controller'</span> <span class="o">=&gt;</span> <span class="s1">'foo'</span><span class="p">,</span>
    <span class="s1">'action'</span>     <span class="o">=&gt;</span> <span class="s1">'view'</span><span class="p">,</span>
    <span class="s1">'slug'</span>       <span class="o">=&gt;</span> <span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Podcast'</span><span class="p">][</span><span class="s1">'slug'</span><span class="p">]</span>
  <span class="p">);</span>
  <span class="nx">App</span><span class="o">::</span><span class="na">import</span><span class="p">(</span><span class="s1">'Sanitize'</span><span class="p">);</span>
  <span class="c1">// This is the part where we clean the body text for output as the description
</span>  <span class="c1">// of the rss item, this needs to have only text to make sure the feed validates
</span>  <span class="c1">// Descripción del podcast
</span>  <span class="nv">$bodyText</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">'=\(.*?\)=is'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="nb">strip_tags</span><span class="p">(</span><span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Podcast'</span><span class="p">][</span><span class="s1">'description'</span><span class="p">]));</span>
  <span class="nv">$bodyText</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Text</span><span class="o">-&gt;</span><span class="na">stripLinks</span><span class="p">(</span><span class="nv">$bodyText</span><span class="p">);</span>
  <span class="nv">$bodyText</span> <span class="o">=</span> <span class="nx">Sanitize</span><span class="o">::</span><span class="na">stripAll</span><span class="p">(</span><span class="nv">$bodyText</span><span class="p">);</span>
  <span class="nv">$bodyText</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Text</span><span class="o">-&gt;</span><span class="na">truncate</span><span class="p">(</span><span class="nv">$bodyText</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'limit'</span> <span class="o">=&gt;</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">'exact'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">));</span>

  <span class="c1">// Título del podcast
</span>  <span class="nv">$item</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$podcat</span><span class="p">[</span><span class="s1">'Podcast'</span><span class="p">][</span><span class="s1">'title'</span><span class="p">]));</span>
  <span class="c1">// Autores
</span>  <span class="nv">$item</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'author'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'namespace'</span> <span class="o">=&gt;</span> <span class="s1">'itunes'</span><span class="p">),</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Podcast'</span><span class="p">][</span><span class="s1">'authors'</span><span class="p">]));</span>
  <span class="c1">// Enlace y guid del podcast
</span>  <span class="nv">$item</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'link'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="nv">$link</span><span class="p">,</span> <span class="kc">true</span><span class="p">));</span>
  <span class="nv">$item</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'guid'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'isPermaLink'</span> <span class="o">=&gt;</span> <span class="s1">'true'</span><span class="p">),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="nv">$link</span><span class="p">,</span> <span class="kc">true</span><span class="p">));</span>
  <span class="c1">// Añadimos la descripción
</span>  <span class="nv">$item</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'summary'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'namespace'</span> <span class="o">=&gt;</span> <span class="s1">'itunes'</span><span class="p">),</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$bodyText</span><span class="p">));</span>
  <span class="nv">$item</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'description'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$bodyText</span><span class="p">));</span>
  <span class="c1">// Fecha de publicación
</span>  <span class="nv">$item</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'pubDate'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Rss</span><span class="o">-&gt;</span><span class="na">time</span><span class="p">(</span><span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Podcast'</span><span class="p">][</span><span class="s1">'created'</span><span class="p">]));</span>

  <span class="c1">// Añadimos la carátula
</span>  <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Cover'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">'file'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$item</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'image'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">'namespace'</span> <span class="o">=&gt;</span> <span class="s1">'itunes'</span><span class="p">,</span>
      <span class="s1">'href'</span> <span class="o">=&gt;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">url</span><span class="p">(</span><span class="s1">'/img/'</span> <span class="o">.</span> <span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Cover'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">'file'</span><span class="p">],</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">));</span>
  <span class="p">}</span>
  <span class="c1">// El fichero de podcast
</span>  <span class="nv">$item</span> <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'enclosure'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'url'</span>    <span class="o">=&gt;</span> <span class="nx">Router</span><span class="o">::</span><span class="na">url</span><span class="p">(</span><span class="s1">'/files/podcasts/'</span> <span class="o">.</span> <span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Podcast'</span><span class="p">][</span><span class="s1">'file'</span><span class="p">],</span> <span class="kc">true</span><span class="p">),</span>
    <span class="s1">'length'</span> <span class="o">=&gt;</span> <span class="nb">filesize</span><span class="p">(</span><span class="nv">$podcast</span><span class="p">[</span><span class="s1">'Podcast'</span><span class="p">][</span><span class="s1">'file'</span><span class="p">]),</span>
    <span class="s1">'type'</span>   <span class="o">=&gt;</span> <span class="s1">'audio/mpeg'</span> <span class="c1">// formato mime del archivo
</span>  <span class="p">));</span>

  <span class="k">echo</span>  <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Xml</span><span class="o">-&gt;</span><span class="na">elem</span><span class="p">(</span><span class="s1">'item'</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nv">$item</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Fijaros bien que todas las URL que he creado las he hecho especificando el segundo parámetro del método “url”; de este modo nos devolverá siempre URL absolutas en lugar de relativas (que es como debe ser en un RSS).</p>

<p>Bien, con esto tendríamos las vistas pero tenemos que decirle a cake que nos las cargue en algún momento. A mi me gusta acceder a través del <strong>nombre_del_controlador.pod</strong></p>

<p>Para hacerle entender a Cake que queremos que distinga las direcciones terminadas en .pod tenemos que abrir nuestro fichero de rutas (<em>routes.php</em>) y añadir la siguiente línea:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5</pre></td><td class="code"><pre><span class="cp">&lt;?php</span> <span class="c1">// /app/config/routes.php
</span><span class="nx">Router</span><span class="o">::</span><span class="na">parseExtensions</span><span class="p">(</span><span class="s1">'pod'</span><span class="p">);</span>
<span class="c1">// Si queréis utilizar más extensiones, como rss u otras
// que necesitéis simplemente id añadiendo parámetros:
// Router::parseExtensions('pod','rss','mrss');
</span></pre></td></tr></tbody></table>
</div>
</div>

<p>En nuestro controlador necesitaremos cargar el componente <em>Request Handler</em> que nos permitirá distinguir desde el controlador los accesos a una página terminada en <strong>.pod</strong>:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21</pre></td><td class="code"><pre><span class="cp">&lt;?php</span> <span class="c1">// /app/controllers/podcasts_controller.php
</span><span class="k">class</span> <span class="nc">PodcastsController</span> <span class="k">extends</span> <span class="nx">AppController</span>
<span class="p">{</span>
  <span class="k">var</span> <span class="nv">$components</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Getid3'</span><span class="p">,</span> <span class="s1">'RequestHandler'</span><span class="p">);</span>
  <span class="k">var</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Xml'</span><span class="p">,</span> <span class="s1">'Rss'</span><span class="p">,</span> <span class="s1">'Html'</span><span class="p">);</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="c1">// Desactivamos el renderizado automático
</span>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">autoRender</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">RequestHandler</span><span class="o">-&gt;</span><span class="na">prefers</span><span class="p">(</span><span class="s1">'pod'</span><span class="p">))</span> <span class="p">{</span>
      <span class="c1">// Hacemos lo que tengamos que hacer para poblar nuestro podcast
</span>      <span class="c1">// $podcasts = $this-&gt;Podcast-&gt;find(...)
</span>
      <span class="c1">// Cargamos la vista y el layout del podcast
</span>      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">'podcasts/index'</span><span class="p">,</span><span class="s1">'xml/podcast'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// Si no es podcast hacemos el render normal
</span>    <span class="k">else</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Como podéis ver el método “prefers” nos permite distinguir entre una terminación u otra. Así pues, si añadiésemos la terminación “jpeg”, haríamos <em>$this-&gt;RequestHandler-&gt;prefers(“jpeg”)</em> para averiguar si el usuario accede a través de ella.</p>

<p>Con esto ya tendríais vuestro podcast funcionando. Para probarlo podéis añadirlo a iTunes desde <em>Avanzado / Subscribirse a un podcast </em>y acto seguido aparecerá en vuestro listado de podcasts.</p>

<p>Si queréis mandarlo a iTunes para que aparezca en la iTunes store podéis hacerlo desde <a href="https://phobos.apple.com/WebObjects/MZFinance.woa/wa/publishPodcast" target="_blank">este enlace</a>.</p>

<p>Si queréis ver un ejemplo podéis ver el podcast del <a href="http://musicavermella.com">netlabel música vermella</a> en <a href="http://itunes.apple.com/es/podcast/musica-vermella-podcast/id417624155" target="_self">itunes</a> o desde la <a href="http://musicavermella.com/#rss" target="_self">propia página web</a>.</p>

<blockquote>
  <p><strong>Ejemplo</strong></p>

  <ul>
    <li><a href="http://itunes.apple.com/es/podcast/musica-vermella-podcast/id417624155" target="_self">Música Vermella Podcast (iTunes)</a></li>
    <li><a href="http://musicavermella.com/#rss">Música Vermella Podcast (Website)</a></li>
  </ul>

  <p><strong>Referencias</strong></p>

  <ul>
    <li><a href="http://www.apple.com/itunes/podcasts/specs.html" target="_self">iTunes Podcast Specs</a></li>
    <li><a href="http://book.cakephp.org/" target="_self">CakePHP Book</a></li>
    <li><a href="http://api.cakephp.org/" target="_self">CakePHP Api</a></li>
  </ul>
</blockquote>

<p>A disfrutarlo :)</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated">
        <time datetime="2011-02-06T21:26:48+01:00">
          <a href="//elboletaire.github.io/racotecnic/2011/02/backups-incrementales-via-ftp-en-linux/">February 06, 2011</a>
        </time>
      </span>
      <span class="author vcard"><span class="fn">
        
        <a href="http://www.underave.net" title="About Booletaire">
          Booletaire
        </a>
        
      </span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~5 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//elboletaire.github.io/racotecnic/2011/02/backups-incrementales-via-ftp-en-linux/" rel="bookmark" title="Backups incrementales vía FTP en Linux" itemprop="url">Backups incrementales vía FTP en Linux</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Recientemente he decidido pagar un servidor compartido para hacer las copias de seguridad de mis documentos, imágenes y demás. Es un servidor realmente barato pero con la pega que no tengo acceso vía SSH, lo que me ha impedido utilizar aplicaciones como rsync o similares.</p>

<p>Después de buscar un rato la única solución viable que he encontrado ha sido lftp, ya que es el único modo que he encontrado de hacer copias incrementales vía FTP.</p>

<p>lftp tiene un método llamado “mirror” que es el que nos permitirá hacer esto. Un ejemplo sencillo de su uso sería…</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre>lftp -c <span class="s1">'set ftp:list-options -a;
    open ftp://usuarioftp:passwordftp@hostftp;
    lcd /directorio/donde/copiar;
    cd /directorio/local/a/copiar;
    mirror --reverse \
           --delete;
    close -a;'</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Como también quería hacer backups de MySQL he decidido entretenerme un rato y hacer mi primer script de bash para hacer copias de mysql y directorios del sistema periódicamente (cada dos días a través de un cron).</p>

<p>Para utilizar el script necesitaréis tener instalado en vuestro servidor linux los paquetes lftp y mailx (o hairloom-mailx); este último servirá para enviarnos un e-mail en caso de error en la subida de nuestros backups. <a id="more"></a><a id="more-1811"></a></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="c"># :: General Backup Setup ::</span>
<span class="nv">BACKUP</span><span class="o">=</span>/tmp/backup.<span class="nv">$$</span>
<span class="nv">NOW</span><span class="o">=</span><span class="k">$(</span>date +<span class="s1">'%Y%m%d'</span><span class="k">)</span>
<span class="nv">EMAILID</span><span class="o">=</span><span class="s1">'tu_correo@ejemplo.com'</span>
<span class="nv">DOMYSQL</span><span class="o">=</span>1 <span class="c"># 0 para no hacer copia de seguridad de mysql</span>
<span class="nv">DOSYSTEM</span><span class="o">=</span>1 <span class="c"># 0 para no hacer copia de seguridad del sistema</span>
<span class="nv">DEBUG</span><span class="o">=</span>0 <span class="c"># 1 activa un poco de debug (pero solo un poco xD)</span>

<span class="c"># :: File System Backup Setup ::</span>
<span class="nv">FOLDERS</span><span class="o">=(</span> <span class="s1">'/home/usuario/Documentos'</span> <span class="s1">'/home/usuario/Imágenes'</span> <span class="o">)</span>
<span class="c"># FTP destination folder</span>
<span class="nv">SFOLDER</span><span class="o">=</span><span class="s1">'directorio_destino_donde_guardar_la_copia'</span>

<span class="c"># :: MySQL Backup Setup ::</span>
<span class="nv">MUSER</span><span class="o">=</span><span class="s1">'usuarioSQL'</span>
<span class="nv">MPASS</span><span class="o">=</span><span class="s1">'pass'</span>
<span class="nv">MHOST</span><span class="o">=</span><span class="s1">'localhost'</span>
<span class="c"># MySQL FTP destination folder</span>
<span class="nv">MFOLDER</span><span class="o">=</span><span class="s1">'directorio_destino_donde_guardar_los_sql'</span>

<span class="c"># :: FTP server Setup ::</span>
<span class="c"># Root FTP folder</span>
<span class="nv">RCD</span><span class="o">=</span><span class="s1">'/directorio_raiz_del_servidor'</span>
<span class="nv">FUSER</span><span class="o">=</span><span class="s1">'usuario'</span>
<span class="nv">FPASS</span><span class="o">=</span><span class="s1">'contraseña'</span>
<span class="nv">FHOST</span><span class="o">=</span><span class="s1">'servidor.dominio'</span>
<span class="nv">FOPTIONS</span><span class="o">=</span><span class="s1">'set ftp:list-options -a;set ftp:ssl-allow no'</span> <span class="c">#;set net:limit-total-rate 61440'</span>

<span class="c"># end config</span>

<span class="c"># :: Binaries ::</span>
<span class="nv">MYSQL</span><span class="o">=</span><span class="s1">'$(which mysql)'</span>
<span class="nv">MYSQLDUMP</span><span class="o">=</span><span class="s1">'$(which mysqldump)'</span>
<span class="nv">GZIP</span><span class="o">=</span><span class="s1">'$(which gzip)'</span>
<span class="nv">FTP</span><span class="o">=</span><span class="s1">'$(which lftp)'</span>

debug<span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$DEBUG</span> <span class="o">==</span> 1 <span class="o">]</span>; <span class="k">then
    </span><span class="nb">echo</span> <span class="nv">$1</span>
  <span class="k">fi</span>
<span class="o">}</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$DOMYSQL</span> <span class="o">==</span> 1 <span class="o">]</span>; <span class="k">then</span>
  <span class="c"># Create backup folder</span>
  debug <span class="s1">'Creating backup folder ${BACKUP}'</span>
  <span class="o">[</span> ! -d <span class="nv">$BACKUP</span> <span class="o">]</span> &amp;amp;&amp;amp; mkdir -p <span class="s1">'${BACKUP}'</span> <span class="o">||</span> :

  <span class="c"># Start MySQL backup</span>
  debug <span class="s1">'Showing databases...'</span>
  <span class="nv">DBS</span><span class="o">=</span><span class="s1">'$($MYSQL -u $MUSER -h $MHOST -p$MPASS -Bse '</span>show databases<span class="s1">')'</span>
  <span class="k">for </span>db <span class="k">in</span> <span class="nv">$DBS</span>
  <span class="k">do
   if</span> <span class="o">[</span> <span class="nv">$db</span> !<span class="o">=</span> <span class="s1">'information_schema'</span> <span class="o">]</span>; <span class="k">then
   </span>debug <span class="s1">'Creating $db.sql.gz backup file'</span>
   <span class="nv">FILE</span><span class="o">=</span><span class="nv">$BACKUP</span>/<span class="nv">$db</span>.sql.gz
   <span class="nv">$MYSQLDUMP</span> -u <span class="nv">$MUSER</span> -h <span class="nv">$MHOST</span> -p<span class="nv">$MPASS</span> <span class="nv">$db</span> | <span class="nv">$GZIP</span> -9 &gt; <span class="nv">$FILE</span>
   chmod 755 <span class="nv">$FILE</span>
   <span class="k">fi
  done</span>
  <span class="c"># Start FTP backup using lftp</span>
  debug <span class="s1">'Starting FTP transaction for MySQL backup files...'</span>
  <span class="nv">$FTP</span> -c <span class="s1">'$FOPTIONS;
  open ftp://$FUSER:$FPASS@$FHOST;
  lcd $BACKUP;
  cd $RCD/$MFOLDER;
  mkdir ${NOW};
  cd ${NOW};
  mirror  --reverse \
      --delete;
  close -a;'</span>

  <span class="c"># Find out if ftp mysql backup failed or not</span>
  <span class="k">if</span> <span class="o">[</span> <span class="s1">'$?'</span> !<span class="o">=</span> <span class="s1">'0'</span> <span class="o">]</span>; <span class="k">then
   </span>debug <span class="s1">'FTP upload failed'</span>
   <span class="nv">T</span><span class="o">=</span>/tmp/backup.fail
   <span class="nb">echo</span> <span class="s1">'Date: $(date)'</span>&gt;<span class="nv">$T</span>
   <span class="nb">echo</span> <span class="s1">'Hostname: $(hostname)'</span> &gt;&gt;<span class="nv">$T</span>
   <span class="nb">echo</span> <span class="s1">'Backup failed'</span> &gt;&gt;<span class="nv">$T</span>
   mail  -s <span class="s1">'MYSQL BACKUP FAILED'</span> <span class="s1">'$EMAILID'</span> &lt;<span class="nv">$T</span>
   rm -f <span class="nv">$T</span>
  <span class="k">fi</span>

  <span class="c"># Delete files</span>
  debug <span class="s1">'Removing files...'</span>
  <span class="k">if</span> <span class="o">[</span> <span class="nv">$DEBUG</span> <span class="o">]</span>; <span class="k">then
    </span>rm -frv <span class="nv">$BACKUP</span>
  <span class="k">else
    </span>rm -fr <span class="nv">$BACKUP</span>
  <span class="k">fi
fi

if</span> <span class="o">[</span> <span class="nv">$DOSYSTEM</span> <span class="o">==</span> 1 <span class="o">]</span>; <span class="k">then</span>
  <span class="c"># Start System Backup</span>
  <span class="c"># Get number of folders</span>
  <span class="nv">FELEM</span><span class="o">=</span><span class="k">${#</span><span class="nv">FOLDERS</span><span class="p">[@]</span><span class="k">}</span>
  <span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span>0;i&lt;<span class="nv">$FELEM</span>;i++<span class="o">))</span>; <span class="k">do
    </span><span class="nv">THISFOLDER</span><span class="o">=</span><span class="k">${</span><span class="nv">FOLDERS</span><span class="p">[</span><span class="k">${</span><span class="nv">i</span><span class="k">}</span><span class="p">]</span><span class="k">}</span>
    <span class="k">if</span> <span class="o">[</span> -d <span class="nv">$THISFOLDER</span> <span class="o">]</span>; <span class="k">then
      </span>debug <span class="s1">'$THISFOLDER exists'</span>
      <span class="nv">REMOTEFOLDER</span><span class="o">=(</span> <span class="k">$(</span><span class="nb">echo</span> <span class="nv">$THISFOLDER</span> | tr <span class="s1">'/'</span> <span class="s1">' '</span><span class="k">)</span> <span class="o">)</span>
      <span class="nv">REMOTEFOLDER</span><span class="o">=</span><span class="k">${</span><span class="nv">REMOTEFOLDER</span><span class="p">[</span><span class="k">${#</span><span class="nv">REMOTEFOLDER</span><span class="p">[@]</span><span class="k">}</span><span class="p">-1]</span><span class="k">}</span>
      debug <span class="s1">'Using $REMOTEFOLDER as remote folder name'</span>
      debug <span class="s1">'Starting FTP transaction from $THISFOLDER to $RCD/$SFOLDER/$REMOTEFOLDER'</span>
      <span class="c"># FTP transfer</span>
      <span class="nv">$FTP</span> -c <span class="s1">'$FOPTIONS;
        open ftp://$FUSER:$FPASS@$FHOST;
        lcd $THISFOLDER;
        cd $RCD/$SFOLDER;
        mkdir $REMOTEFOLDER;
        cd $REMOTEFOLDER;
        mirror  --reverse \
            --delete;
        close -a;'</span>
      <span class="c"># Find out if ftp system backup failed</span>
      <span class="k">if</span> <span class="o">[</span> <span class="s1">'$?'</span> !<span class="o">=</span> <span class="s1">'0'</span> <span class="o">]</span>; <span class="k">then
       </span>debug <span class="s1">'File system backup failed'</span>
       <span class="nv">T</span><span class="o">=</span>/tmp/backup.fail
       <span class="nb">echo</span> <span class="s1">'Date: $(date)'</span>&gt;<span class="nv">$T</span>
       <span class="nb">echo</span> <span class="s1">'Hostname: $(hostname)'</span> &gt;&gt;<span class="nv">$T</span>
       <span class="nb">echo</span> <span class="s1">'Backup failed on dir $THISFOLDER'</span> &gt;&gt;<span class="nv">$T</span>
       mail  -s <span class="s1">'SYSTEM BACKUP FAILED'</span> <span class="s1">'$EMAILID'</span> &lt;<span class="nv">$T</span>
       rm -f <span class="nv">$T</span>
      <span class="k">fi
    fi
  done
fi</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Como he dicho, es el primer script de bash que he hecho en la vida (a parte de alguno otro realmente tonto..) así que si me proponéis ideas para mejorarlo o encontráis algún error os agradecería que me lo comentarais :)</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
    <div class="entry-meta">
      <span class="entry-date date published updated">
        <time datetime="2011-02-05T14:14:20+01:00">
          <a href="//elboletaire.github.io/racotecnic/2011/02/introduccion-a-html5-principios-basicos/">February 05, 2011</a>
        </time>
      </span>
      <span class="author vcard"><span class="fn">
        
        <a href="http://" title="About DPAM23">
          DPAM23
        </a>
        
      </span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
Reading time ~6 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="//elboletaire.github.io/racotecnic/2011/02/introduccion-a-html5-principios-basicos/" rel="bookmark" title="Introducción a HTML5 - principios básicos" itemprop="url">Introducción a HTML5 - principios básicos</a></h1>
    
  </header>
  <div class="entry-content">
    <p><img class="alignleft size-thumbnail wp-image-1771" title="HTML5" src="//elboletaire.github.io/racotecnic/uploads/2011/02/HTML5-150x150.jpg" alt="HTML5 Logotype" width="150" height="150" />Desde hace unos días estoy inscrito en un curso gratuito y online de HTML5,  gestionado desde la <a href="http://p2pu.org/course/list">P2PU</a> con el soporte de <a href="http://www.drumbeat.org/project/p2p-university-open-web-career-track">Mozilla</a>.
Estos cursos los da gente anónima y desinteresada, por lo que en general no son docentes sino gente con conocimientos y ganas de explicar cosas.
Es maravilloso que existan iniciativas de este tipo.</p>

<p>Así que sin más preámbulos, me dispongo a dejar constancia de lo aprendido en la primera clase.</p>

<h2 id="que-hay-de-nuevo-en-html5">¿Que hay de nuevo en HTML5?</h2>

<p>El principal cambio en el que nos centraremos hoy radica en los elementos de la nueva semántica: Es decir, en el HTML vamos a empezar a utilizar unas etiquetas que son mucho más específicas (en lugar de los ambiguos DIV a los que estábamos acostumbrados).</p>

<p>Esto no significa que dejemos de utilizar DIVs, sino que ahora tenemos más etiquetas.</p>

<p>Por ejemplo, algunas de las más comunes:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1</pre></td><td class="code"><pre><span class="nt">&lt;header&gt;&lt;footer&gt;&lt;nav&gt;&lt;aside&gt;&lt;article&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Su mismo nombre ya nos dice más o menos dónde irán ubicadas.</p>

<p>En <a href="http://www.w3schools.com/html5/html5_reference.asp">w3schools</a> tienen una lista completa de todas las etiquetas nuevas.</p>

<p>Vamos a comparar como se creaba antes la estructura de una web y como se hará com HTML5:<a id="more"></a><a id="more-1770"></a></p>

<h2 id="antigua-estructura">Antigua estructura:</h2>

<p><img class="size-full wp-image-1779" title="html5_1" src="//elboletaire.github.io/racotecnic/uploads/2011/02/html5_11.png" alt="" width="270" height="251" /></p>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td class="code"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">'header'</span><span class="nt">&gt;&lt;h1&gt;</span>Título de la página<span class="nt">&lt;/h1&gt;&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">'post'</span><span class="nt">&gt;</span>Contenido del post<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">'post'</span><span class="nt">&gt;</span>Contenido del post<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">'sidebar'</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ul&gt;</span>
    <span class="nt">&lt;li&gt;</span>Elementos típicos del sidebar<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">'footer'</span><span class="nt">&gt;</span>
  Elementos típicos del footer
<span class="nt">&lt;/div&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="nueva-estructura">Nueva estructura:</h2>

<p><img class="size-full wp-image-1780" title="html5_2" src="//elboletaire.github.io/racotecnic/uploads/2011/02/html5_2.png" alt="" width="270" height="251" /></p>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15</pre></td><td class="code"><pre><span class="nt">&lt;header&gt;&lt;h1&gt;</span>Título de la página<span class="nt">&lt;/h1&gt;&lt;/header&gt;</span>

<span class="nt">&lt;article&gt;</span>Contenido del post<span class="nt">&lt;/article&gt;</span>

<span class="nt">&lt;article&gt;</span>Contenido del post<span class="nt">&lt;/article&gt;</span>

<span class="nt">&lt;aside&gt;</span>
  <span class="nt">&lt;ul&gt;</span>
    <span class="nt">&lt;li&gt;</span>Elementos típicos del sidebar<span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/aside&gt;</span>

<span class="nt">&lt;footer&gt;</span>
  Elementos típicos del footer
<span class="nt">&lt;/footer&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Como podéis observar, las etiquetas son mucho más semánticas y específicas.</p>

<h2 id="ejemplos-reales--típicos-usos">Ejemplos reales : típicos usos:</h2>

<h3 id="header">&lt;header&gt;</h3>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12</pre></td><td class="code"><pre><span class="nt">&lt;header&gt;</span>
  <span class="nt">&lt;hgroup&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Thai cookery school&gt;<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;h2&gt;</span>Learn authentic Thai cookery in your own home <span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;/hgroup&gt;</span>
  <span class="nt">&lt;nav&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
      <span class="nt">&lt;li&gt;</span>Home<span class="nt">&lt;/li&gt;</span> <span class="nt">&lt;li&gt;</span> <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">”courses.html”</span><span class="nt">&gt;</span>Cookery courses<span class="nt">&lt;/a&gt;</span> <span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">”contact.html”</span><span class="nt">&gt;</span>Contact<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/nav&gt;</span>
<span class="nt">&lt;/header&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="nav">&lt;nav&gt;</h3>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7</pre></td><td class="code"><pre><span class="nt">&lt;nav&gt;</span>
  <span class="nt">&lt;h2&gt;</span>Main navigation<span class="nt">&lt;/h2&gt;</span>
  <span class="nt">&lt;ul&gt;</span>
    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">”/about”</span><span class="nt">&gt;</span>About me<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">”/news”</span><span class="nt">&gt;</span>News<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="aside">&lt;aside&gt;</h3>

<p>(Por ejemplo un sidebar de un blog)</p>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14</pre></td><td class="code"><pre><span class="nt">&lt;aside&gt;</span>
  <span class="nt">&lt;nav&gt;</span>
    <span class="nt">&lt;h2&gt;</span>Pages<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;ul&gt;</span> .. <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/nav&gt;</span>
  <span class="nt">&lt;nav&gt;</span>
    <span class="nt">&lt;h2&gt;</span>Recent comments<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;ul&gt;</span> ... <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/nav&gt;</span>
  <span class="nt">&lt;nav&gt;</span>
    <span class="nt">&lt;h2&gt;</span>Last posts<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;ul&gt;</span> ... <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/nav&gt;</span>
<span class="nt">&lt;/aside&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h3 id="footer">&lt;footer&gt;</h3>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3</pre></td><td class="code"><pre><span class="nt">&lt;footer&gt;</span>
  <span class="nt">&lt;small&gt;</span><span class="ni">&amp;copy;</span>2010 Xpenta.com. Design by dpam23<span class="nt">&lt;/small&gt;</span>
<span class="nt">&lt;/footer&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="mínima-expresión-de-página-en-html5">Mínima expresión de página en HTML5</h2>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10</pre></td><td class="code"><pre><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">en</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">utf-8</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>mi blog<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    Hoy dictaré la clase de html5. Desayunaré, Y volveré a la cama.
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Aquí podemos observar que las directrices básicas son mucho más escuetas (como por ejemplo el doctype).</p>

<h2 id="estilando-html5-con-css">Estilando HTML5 con CSS:</h2>

<p>Bien, ahora que ya tenemos un poco más clara la estructura de etiquetas en HTML5, tendremos que aplicarle estilos.</p>

<p>En todos los navegadores menos uno, es muy simple dar estilos a un elemento. Igual que hacíamos con HTML4, creamos una hoja de estilos CSS y desde allí hacemos las llamadas a los elementos.</p>

<p>por ejemplo:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></td><td class="code"><pre><span class="nt">header</span> <span class="p">{</span>
  <span class="nl">background-color</span> <span class="p">:</span> <span class="m">#ececec</span><span class="p">;</span>
  <span class="nl">text-align</span>       <span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
  <span class="nl">color</span>            <span class="p">:</span> <span class="m">#bbb</span><span class="p">;</span>
<span class="p">}</span>
  <span class="nt">header</span> <span class="nt">h1</span> <span class="p">{</span>
    <span class="nl">padding</span> <span class="p">:</span> <span class="m">30px</span><span class="p">;</span>
    <span class="nl">margin</span>  <span class="p">:</span> <span class="m">0</span><span class="p">;</span>
  <span class="p">}</span>

<span class="nt">article</span> <span class="p">{</span>
  <span class="nl">padding</span>       <span class="p">:</span> <span class="m">30px</span><span class="p">;</span>
  <span class="nl">width</span>         <span class="p">:</span> <span class="m">570px</span><span class="p">;</span>
  <span class="nl">float</span>         <span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
  <span class="nl">border-bottom</span> <span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#ebebeb</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">aside</span> <span class="p">{</span>
  <span class="nl">width</span>            <span class="p">:</span> <span class="m">269px</span><span class="p">;</span>
  <span class="nl">float</span>            <span class="p">:</span> <span class="nb">right</span><span class="p">;</span>
  <span class="nl">border-left</span>      <span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#ebebeb</span><span class="p">;</span>
  <span class="nl">background-color</span> <span class="p">:</span> <span class="m">#F7F6F6</span><span class="p">;</span>
<span class="p">}</span>
  <span class="nt">aside</span> <span class="nt">nav</span><span class="o">,</span> <span class="nt">aside</span> <span class="nt">section</span> <span class="p">{</span>
    <span class="nl">padding</span><span class="p">:</span><span class="m">30px</span><span class="p">;</span>
  <span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>Lo que más sorprende de este nuevo sistema, es que por defecto CSS asume que este tipo de elementos tienen la propiedad display:inline, así que si queremos poner alturas o anchuras, tendremos que cambiarlo a display:block;</p>

<div class="language-css highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="c">/* Tell the browser to render HTML 5 elements as block */</span>
<span class="nt">header</span><span class="o">,</span> <span class="nt">footer</span><span class="o">,</span> <span class="nt">aside</span><span class="o">,</span> <span class="nt">nav</span><span class="o">,</span> <span class="nt">article</span><span class="o">,</span> <span class="nt">section</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table>
</div>
</div>

<h2 id="peculiaridades-de-internet-explorer-ie-y-html5">Peculiaridades de Internet explorer (IE) y HTML5</h2>

<p>Con las versiones actuales de IE, siguiendo las instrucciones anteriormente expuestas, la página permanecerá sin estilos. O mejor dicho, tendrán estilos aquellos elementos típicos de HTML4 (span, div, a…) pero dejará sin estilos los nuevos de HTML5 (header, footer, section, canvas…)</p>

<p>para evitar esto, tendremos que añadir un script al documento:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6</pre></td><td class="code"><pre><span class="nt">&lt;script&gt;</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'header'</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'nav'</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'article'</span><span class="p">);</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'footer'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></td></tr></tbody></table>
</div>
</div>

<p>De esta manera, y son motivo aparente, los elementos cojerán los estilos indicados en el CSS.
Tendremos que crear una línea para cada elemento que queramos crear.
Este script lo podemos poner con los típicos condicionales para que sólo los lea IE, pero si los dejamos para todos los navegadores no pasa nada.</p>

<h2 id="demo-ejemplo-práctico">DEMO: Ejemplo práctico</h2>

<p>Todo esto está muy bien, pero ¿y si lo vemos todo junto?
Os dejo una página sencilla en HTML5 y algo de CSS3.
Es el primer ejercicio que nos han pedido, veremos a ver que nota me ponen! :)</p>

<p><a href="http://demos.racotecnic.com/tutorials/2011/HTML5/" title="HTML5 example">http://demos.racotecnic.com/tutorials/2011/HTML5/</a></p>

<h2 id="documentación-interesante">Documentación interesante:</h2>

<blockquote>
  <ul>
    <li>Smashingshare:  <a href="http://smashingshare.com/2010/04/28/ultimate-collection-of-html5-and-css3-resources/" title="HTML5 &amp; CSS3 ressources">ultimate-collection-of-html5-and-css3-resources</a></li>
    <li>Splashnology: <a href="http://www.splashnology.com/blog/html5/968.html" title="HTML5"> Useful HTML5 &amp; CSS3 Toolbox For Web Developers </a> </li>
    <li><a href="http://bit.ly/guvTze" title="Videotutoriales">Curso videotutoriales de HTML5 </a> creado por Jesús Conde (0utKast).</li>
    <li>Curso en video HTML5 - First Look / Ingles (<a href="http://ir.pe/3tqb" title="Curso en video">Descarga gratuita</a>)</li>
    <li>Libro HTML5: Designing Rich Internet Applications / Ingles - (<a href="http://ir.pe/3tqd" title="Libro HTML5">Descarga gratuita</a>) </li>
    <li>Libro HTML5 for web designers/Ingles (<a href="http://ir.pe/3tqe" title="Libro HTML5">Descarga gratuita</a>)</li>
    <li>Conferencia HTML5 para diseñadores-CampusParty / Español <a href="http://ir.pe/3tqf" title="Conferencia HTML5">http://ir.pe/3tqf</a></li>
    <li>Conferencia HTML5 para principiantes / Español by @soska- <a href="http://ir.pe/3tqg" title="Conferencia HTML5">http://ir.pe/3tqg</a></li>
    <li>Conferencia Introduction to HTML5 / Ingles by Google Developers <a href="http://ir.pe/3tqh" title="Conferencia Introduction to HTML5">http://ir.pe/3tqh</a></li>
    <li>Ejemplos y tutoriales de HTML5 <a href="http://www.html5rocks.com/" title="ejemplos y tutoriales de HTML5">http://www.html5rocks.com/</a></li>
  </ul>
  <p>PD: Gracias a los alumnos del curso por compartir estos enlaces tan interesantes!</p>
</blockquote>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  <ul class="inline-list">
    
    
      
        <li><a href="//elboletaire.github.io/racotecnic/page/3/" class="btn">Previous</a></li>
      
    

    
    
      <li><a href="//elboletaire.github.io/racotecnic">1</a></li>
    

    
    

    
    
    

    
      
        
        
        
        <li><a href="//elboletaire.github.io/racotecnic/page/2/">2</a></li>
      
    
      
        
        
        
        <li><a href="//elboletaire.github.io/racotecnic/page/3/">3</a></li>
      
    
      
        <li><strong class="current-page">4</strong></li>
      
    
      
        
        
        
        <li><a href="//elboletaire.github.io/racotecnic/page/5/">5</a></li>
      
    
      
        
        
        
        <li><a href="//elboletaire.github.io/racotecnic/page/6/">6</a></li>
      
    

    
    
      <li>…</li>
    

    
      <li><a href="//elboletaire.github.io/racotecnic/page/23/">23</a></li>
    

    
    
      <li><a href="//elboletaire.github.io/racotecnic/page/5/" class="btn">Next</a></li>
    
  </ul>
</div>



</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2017 Racó Tècnic. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="//elboletaire.github.io/racotecnic/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="//elboletaire.github.io/racotecnic/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106861877-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>




</body>
</html>
